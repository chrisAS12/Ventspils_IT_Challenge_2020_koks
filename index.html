<!DOCTYPE html>
<html lang = "en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air Polution Simulation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js" integrity="sha512-QEiC894KVkN9Tsoi6+mKf8HaCLJvyA6QIRzY5KrfINXYuP9NxdIkRQhGq3BZi0J4I7V5SidGM3XUQ5wFiMDuWg==" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="resources\css\main.css">
</head>

<body>
    <h2 style="font-size: 40px;"> The whole world encounters the same problem - air pollution! </h2>
    <div class="container">
        <canvas id = "chart">
 
        </canvas>
    </div>
    <div class="slider-container">
        <div class="width">
            <h3>Dome width (km)</h3>
            <input type="range" min="10" max="1000" value="500" class="slider" id="domeWidth">
            <p class="sliderValue" id="domeWidthValue">VALUE: 500 km</p>
        </div>
        <div class="height" style="margin-left: 2.5rem;">
            <h3>Trees per square meter.(m)</h3>
            <input type="range" min="3" max="0.1" value="1" class="slider" id="treesPerSquareMeter">
            <p class="sliderValue" id="treesPerSquareMeterValue">VALUE: 10 m</p>
        </div>
        
    </div>
    <div class="button-container">
        <button style="margin-top: 3rem; margin-bottom: 20rem;" onclick="calculateDome();">SIMULATE!</button>
    </div>


    <script>
            
        Chart.defaults.global.defaultFontFamily = 'Helvetica';
        Chart.defaults.global.defaultFontSize =  18;
        Chart.defaults.global.defaultFontColor =  '#777';

        let days = 365;
        let i;
        let dayArray = new Array();
        for( i = 1; i < days; i++){
            dayArray[i-1] = 'Day ' + i ; 
        }

        let ctx = document.getElementById("chart").getContext('2d');

        function addData(chart,volume, oxygen, nitrogen, co){
           chart.data.datasets[0].data.push(oxygen); // O2 Label
           chart.data.datasets[1].data.push(nitrogen); // CO2 Label
           chart.data.datasets[2].data.push(co);
           chart.update();
        }

        let pollutionChart = new Chart(ctx, {
            type:'bar', 
            data:{
                labels: dayArray,
                datasets:[{
                    label:'O2',
                    data:[
                      
                    ],
                    backgroundColor:'green',
                    borderWidth: 1,
                    borderColor: '#777',
                    hoverBorderWidth: 3,
                    hoverBorderColor: '#0000'
                },
                {
                    label:'N2',
                    data:[
                      
                    ],
                    backgroundColor:'red',
                    borderWidth: 1,
                    borderColor: '#777',
                    hoverBorderWidth: 3,
                    hoverBorderColor: '#0000'
                },
                {
                    label:'CO2',
                    data:[
                      
                    ],
                    backgroundColor:'gray',
                    borderWidth: 1,
                    borderColor: '#777',
                    hoverBorderWidth: 3,
                    hoverBorderColor: '#0000'
                }

                ]
            },
            options:{
                title:{
                    display:true,
                    text:'Ventspils ITC simulÄcija',
                    fontSize: 25,
                    fontColor: '#FBEEC1'
                },
                legend:{
                    labels:{
                        fontColor:'white'
                    }
                },
                scales: {
                    xAxes: [{
                         stacked: true
                }],
                 yAxes: [{
                          stacked: true
            }]
        }
                
            }
        });

        var width = 500;
        var treesPerSquareMeter = 10;

        var widthValue = document.getElementById('domeWidthValue');
        var widthSlider = document.getElementById('domeWidth');
        widthSlider.oninput = function() {
            width = this.value;
            widthValue.innerHTML = "VALUE: "+ width + " km";
        } 

        var treesPerSquareMeterValue = document.getElementById('treesPerSquareMeterValue');
        var treesPerSquareMeterSlider = document.getElementById('treesPerSquareMeter');
        treesPerSquareMeterSlider.oninput = function() {
            treesPerSquareMeter = this.value;
            treesPerSquareMeterValue.innerHTML = "VALUE: " + treesPerSquareMeter + " m";
        } 

    
       var domeVolume = 0;
       
       function calculateDome(){
            domeVolume = Math.round((2/3) * Math.PI * Math.pow(width/2,3));
            console.log(domeVolume);
       }
       
       i = 0;
       for ( i = 1; i < days; i++){
           addData(pollutionChart,domeVolume, (20.9), (78), (0.03));
       }

    </script>
</body>

</html>