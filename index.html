<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air Polution Simulation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js"
        integrity="sha512-QEiC894KVkN9Tsoi6+mKf8HaCLJvyA6QIRzY5KrfINXYuP9NxdIkRQhGq3BZi0J4I7V5SidGM3XUQ5wFiMDuWg=="
        crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="resources\css\main.css">
    <link rel="shortcut icon" type="image/png" href="resources/img/favicon.png">
</head>

<body>
    <h2 style="font-size: 40px;"> The whole world encounters the same problem - air pollution! </h2>
    <div class="sim-container">
        <div class="chart-container" style="height:60vh; width: 100vh;">
            <canvas id="chart" class="chart">

            </canvas>
        </div>
        <div class="slider-container">
            <div class="radius" style="margin-left: 1rem; margin-top: 2rem;">
                <h3>Dome radius (km)</h3>
                <input type="range" min="10" max="1000" value="500" class="slider" id="domeRadius">
                <p class="sliderValue" id="domeRadiusValue">VALUE: 500 (KM)</p>
            </div>
            <div class="treesPerSquareMeter" style="margin-left: 1rem;">
                <h3>Trees per square meter (N)</h3>
                <input type="range" min="0" max="150" value="50" class="slider" id="treesPerSquareMeter">
                <p class="sliderValue" id="treesPerSquareMeterValue">VALUE: 0.5 (N/M^2)</p>
            </div>
           
        </div>

    </div>
    <div class="button-container">
        <button style="margin-top: 3rem; margin-bottom: 20rem;" onclick="newParameters();">NEW PARAMETERS!</button>
        <button style="margin-top: 3rem; margin-bottom: 20rem;" onclick="simulateADay();">SIMULATE A DAY!</button>
    </div>


    <script>
        Chart.defaults.global.defaultFontFamily = 'Helvetica';
        Chart.defaults.global.defaultFontSize = 18;
        Chart.defaults.global.defaultFontColor = '#777';
        Chart.defaults.global.responsive = true;
        Chart.defaults.global.maintainAspectRatio = false;

        let ctx = document.getElementById("chart").getContext('2d');

        var radius = 500;
        var treesPerSquareMeter = 0.5;

        var radiusValue = document.getElementById('domeRadiusValue');
        var radiusSlider = document.getElementById('domeRadius');
        radiusSlider.oninput = function () {
            radius = this.value;
            radiusValue.innerHTML = "VALUE: " + radius + " (KM)";
        }

        var treesPerSquareMeterValue = document.getElementById('treesPerSquareMeterValue');
        var treesPerSquareMeterSlider = document.getElementById('treesPerSquareMeter');
        treesPerSquareMeterSlider.oninput = function () {
            treesPerSquareMeter = this.value / 100;
            treesPerSquareMeterValue.innerHTML = "VALUE: " + treesPerSquareMeter + " (N/M^2)";
        }


        var i = 1;
        var dayArray = new Array();

        function addOneLabel(){
            console.log(dayArray.length);
            dayArray[dayArray.length] = 'Day ' + (dayArray.length+1);
            treeChart.update();
        }

        function addDataToLabels(chart, area, birch, oak, spruce) {
            chart.data.datasets[0].data.push(birch); // Birch Label
            chart.data.datasets[1].data.push(oak); // Oak Label
            chart.data.datasets[2].data.push(spruce); // Spruce Label
            chart.update();
        }

        var treeChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: dayArray,
                datasets: [{
                        label: 'Birch',
                        data: [

                        ],
                        backgroundColor: 'green',
                        borderradius: 1,
                        borderColor: '#777',
                        hoverBorderradius: 3,
                        hoverBorderColor: '#0000'
                    },
                    {
                        label: 'Oak',
                        data: [

                        ],
                        backgroundColor: 'red',
                        borderradius: 1,
                        borderColor: '#777',
                        hoverBorderradius: 3,
                        hoverBorderColor: '#0000'
                    },
                    {
                        label: 'Spruce',
                        data: [

                        ],
                        backgroundColor: 'gray',
                        borderradius: 1,
                        borderColor: '#777',
                        hoverBorderradius: 3,
                        hoverBorderColor: '#0000'
                    }

                ]
            },
            options: {
                title: {
                    display: true,
                    text: 'Ventspils ITC simulÄcija',
                    fontSize: 25,
                    fontColor: '#FBEEC1'
                },
                legend: {
                    labels: {
                        fontColor: 'white'
                    }
                },
                scales: {
                    xAxes: [{
                        stacked: true,
                        ticks: {
                            autoSkip: true,
                            maxTicksLimit: 20
                        }
                    }],
                    yAxes: [{
                        stacked: true
                    }]
                },
            }
        });


        var area = 0;
        var trees = 0;

        var birch = 0;
        var oak = 0;
        var spruce = 0;


        function newParameters() {
           while(dayArray.length > 0){
               dayArray.pop();
           }
           treeChart.update();

            area = Math.round(Math.PI * Math.pow(radius, 2));
            console.log("Area: " + area);

            trees = Math.round(area * treesPerSquareMeter);
            console.log("Trees: " + trees);

        }

        function simulateADay(){
            if (area == 0 || trees == 0){
                newParameters();
            }
            addOneLabel();
        }

    </script>
</body>

</html>